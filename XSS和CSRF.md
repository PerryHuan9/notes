## XSS（Cross-Site Script）跨站脚本

### 网站漏洞

* html内嵌的文本中，恶意内容以形成script进行注入
* 在内联的javascript中，拼接的数据突破原本的限制（字符串，变量，方法名等）
* 在标签属性中，恶意内容包含引号突破属性的限制，以插入其它属性或标签
* 在标签的src，href等属性中，恶意插入JavaScript: 等可执行js
* 在标签的onload，onclick等事件中，插入不受控制的代码

### 解决策略

* 防止html中出现注入
* 防止JavaScript执行时，执行恶意代码
* 使用纯前端渲染，使用框架时小心使用v-html
* 使用完善的html转义库对插入的内容进行转义，不同上下文的转义规则不一样
* 使用CSP(Content Security Policy)

#### CSP
严格的 CSP 在 XSS 的防范中可以起到以下的作用：
* 禁止加载外域代码，防止复杂的攻击逻辑。
* 禁止外域提交，网站被攻击后，用户的数据不会泄露到外域。
* 禁止内联脚本执行（规则较严格，目前发现 GitHub 使用）。
* 禁止未授权的脚本执行（新特性，Google Map 移动版在使用）。


## CSRF(Cross-Site Request Forgery) 跨站请求伪造

### CSRF特点

* 攻击一般发起在第三方网站，而不是被攻击的网站。被攻击的网站无法阻止攻击发生。
*  攻击利用受害者在被攻击网站的登录凭证，冒充受害者提交操作；而不是直接窃取数据。
* 整个过程攻击者并不能获取到受害者的登录凭证，仅仅是“冒用”。
* 跨站请求可以用各种方式：图片URL、超链接、CORS、Form提交等等。

### 预防手段

* 后端对接口设置同源检测，可以通过检查Origin或Referer Header。
* 使用token，每个请求都携带token。
* 敏感操作增加交互操作，如输入密码，发送验证码。
* 使用samesite cookie，使cookie只能在当前网站使用。


